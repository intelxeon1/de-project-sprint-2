Спасибо за ревью!
Я поправил все замечания.

Что касается min / max для booked, то в наших данных разницы нет, хотя соглашусь, что логичнее сделать min.